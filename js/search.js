var searchFunc=function(e,t,l){"use strict";var a="<i id='local-search-close'>×</i>",n=document.getElementById(t),r=document.getElementById(l);r.innerHTML=a+"<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>",$.ajax({url:e,dataType:"xml",success:function(e){var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get();r.innerHTML="",n.addEventListener("input",function(){var m='<ul class="search-result-list">',p=this.value.trim().toLowerCase().split(/[\s\-]+/);if(r.innerHTML="",!(this.value.trim().length<=0)){if(t.forEach(function(e){var l=!0;e.title&&""!==e.title.trim()||(e.title="Untitled");var t=e.title.trim(),a=t.toLowerCase(),n=e.content.trim().replace(/<[^>]+>/g,""),r=n.toLowerCase(),c=e.url,s=-1,i=-1,u=-1;if(""!==r?p.forEach(function(e,t){s=a.indexOf(e),i=r.indexOf(e),s<0&&i<0?l=!1:(i<0&&(i=0),0==t&&(u=i))}):l=!1,l){m+="<li><a href='"+c+"' class='search-result-title' target='_blank'>"+t+"</a>";if(0<=u){var o=u-20,h=u+80;o<0&&(o=0),0==o&&(h=100),h>n.length&&(h=n.length);var f=n.substr(o,h);p.forEach(function(e){var t=new RegExp(e,"gi");f=f.replace(t,'<em class="search-keyword">'+e+"</em>")}),m+='<p class="search-result">'+f+"...</p>"}m+="</li>"}}),-1===(m+="</ul>").indexOf("<li>"))return r.innerHTML=a+"<ul><span class='local-search-empty'>没有找到内容，更换下搜索词试试吧~<span></ul>";r.innerHTML=a+m}})}}),$(document).on("click","#local-search-close",function(){$("#local-search-input").val(""),$("#local-search-result").html("")})},getSearchFile=function(){searchFunc("/search.xml","local-search-input","local-search-result")};